<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd">
<!-- saved from url=(0084)file:///C:/Users/TrungHieu/Desktop/Exam1516FR/2.%20Forum%20(SACS%202015%202016).html -->
<html xml:lang="fr" lang="fr" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="generator" content="SPIP 2.1.28">
<meta name="language" content="fr">
<meta name="description" content="SACS 2015 2016">
<!-- alternative std du W3C refuse par l'outil de test d'un certain moteur
  style type='text/css'>@viewport { width: device-width; zoom: 1;}</style-->
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" media="screen, projection" href="./index_files/spip.php">
<link rel="stylesheet" type="text/css" media="print" href="./index_files/impression.css">
<link rel="stylesheet" type="text/css" media="handheld, only screen and (max-device-width: 480px)" href="./index_files/handheld.css">
<link rel="alternate" type="application/rss+xml" title="Syndiquer cette rubrique" href="http://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?page=backend-breves&amp;id_rubrique=2132&amp;titre=%2006/01/2016"><link rel="search" type="application/opensearchdescription+xml" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?page=opensearch.xml" title="SACS 2015 2016">

 <link rel="prefetch" href="http://prefetch.validatorsearch.verisignlabs.com/">
<title>2. Forum (SACS 2015 2016)</title>
<style type="text/css"></style><script type="text/javascript" src="chrome-extension://bfbmjmiodbnnpllbbbfblcplfjjepjdn/js/injected.js"></script></head>
<body class="default-parameters">
<div id="navigation-upmc">
	<div class="menu-lv1">
		<a class="menu-logo" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/ecrire/" title="Espace privé">Espace privé</a>
	</div>
	<div class="menu-lv1"><a href="http://www.upmc.fr/" title="Université Pierre et Marie Curie">UPMC</a></div>
	<div class="menu-lv1 fs80"><a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct" title="Accueil du site">SACS 2015 2016</a></div>
	<div class="menu-lv1">
      <a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/WEB1" title="Structure des Architectures Clients-serveurs">WEB1</a>
</div>


<div class="menu-lv1">Navigation dans la page</div><ul class="menu-lv1">
<li class="menu-lv2">
    <a title="Exercice 1" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#a1">La DTD</a></li>
<li class="menu-lv2">
    <a title="Exercice 2" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#a2">Chargement du forum</a></li>
<li class="menu-lv2">
    <a title="Exercice 3" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#a3">Sauvegarder une réponse</a></li>
<li class="menu-lv2">
    <a title="Exercice 4" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#a4">Script d’insertion d’une réponse</a></li>
<li class="menu-lv2">
    <a title="Exercice 5" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#a5">Présentation des messages</a></li>
<li class="menu-lv2">
    <a title="Exercice 6" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#a6">Ajouter du style</a></li>
<li class="menu-lv2">
    <a title="Exercice 7" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#a7">Voir les réponses à un message</a></li>
<li class="menu-lv2">
    <a title="Exercice 8" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#a8">Envoi d’une réponse</a></li>
<li class="menu-lv2">
    <a title="Exercice 9" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#a9">Signalement de l’insertion</a></li>
<li class="menu-lv2">
    <a title="Exercice 10" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#a10">Application complète</a></li>
<li class="menu-lv2">
    <a title="Exercice 11" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#a11">Statistiques en SVG</a></li>
<li class="menu-lv2">
    <a title="Exercice 12" href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#a12">Annexes</a></li>
</ul>


<div class="menu-lv1">
Authentifié sous<br>Mai Trung Hieu</div>	<div class="menu-lv1-last">&nbsp;</div>
</div>
<div id="content">

<h1>Contrôles des Connaissances<br>2. Forum<br>examen 06/01/2016</h1>
<h2 style="text-align: center; color: red">Mai Trung Hieu
<script type="application/javascript">
var note = 0;
</script>
</h2><div style="color: red; font-style: italic; margin: 2em; text-align: justify">
Les fichiers à créer seront placés dans le sous-répertoire <tt>public_html</tt> de votre répertoire personnel, et seront automatiquement ramassés. Seuls les fichiers demandés le seront, aussi il est impératif de bien contrôler leur création: nom exact (sans confondre minuscules et majuscules, tiret et souligné etc, ni placer des espaces autour du nom) et droit d'accès 640 pour un fichier non exécutable et droit d'accès 750 pour ses répertoires parents ou un fichier exécutable. Dans le cas où une réponse nécessite les fonctions écrites dans une réponse précédente, celles-ci ne doivent pas être recopiées, le recours au mécanisme d'inclusion des langages de programmation étant plus fiable et plus lisible.
</div>

<p>Nous souhaitons dans cet examen créer une application de type forum, permettant à ses utilisateurs de publier des thématiques, des questions, et de les commenter.
Vous trouverez dans l’annexe <i>constantes.php</i> un tableau associatif <tt>$users</tt>, dont les valeurs sont le nom et prénom des utilisateurs du forum et la clef leur code correspondant.
Pour cet examen on suppose l’utilisateur déjà authentifié avec un cookie de nom <tt>code_auth</tt> positionné, ce cookie référence le code devant être une clef dans le tableau <tt>$users</tt>.</p>
<p>Note sur 46, barème sur 60.</p>
<div id="sequence2301">
<span id="e18573"></span>


<h2 id="a1">1 La DTD <small>(4&nbsp;point(s))</small></h2>
<p>Notre forum sauvegarde toutes les questions et réponses saisies dans un fichier nommé <i>forum.xml</i>, dont un exemplaire est fourni en annexe, et qui contient&nbsp;:</p>

<ul class="spip"><li> une balise racine nommée <tt>forum</tt>&nbsp;;</li><li> 0 ou plusieurs balises <tt>post</tt>, avec des attributs obligatoires id, user, category, et date&nbsp;;</li><li> toute balise <tt>post</tt>, correspondant à un message principal, contient une balise obligatoire <tt>subject</tt>, une balise obligatoire <tt>text</tt>, et 0 ou plusieurs balises <tt>response</tt> (correspondant aux réponses apportées au message principal)</li></ul>
<p>Proposez une DTD obéissant à ces spécifications et la plus fidèle possible au fichier fourni en exemple.</p>




<div class="solution" id="s1">
<div>Solution
      <a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4776&amp;cle=6219fa9d8347bf38a8b13156ec864fe1f5de1af1&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fforum.dtd" style="float:right" class="solution">Télécharger forum.dtd</a></div>
<pre>&lt;!ELEMENT forum     (post*)&gt;
&lt;!ELEMENT post    	(subject, text, response*) &gt;

&lt;!ELEMENT subject   (#PCDATA) &gt;
&lt;!ELEMENT text   	(#PCDATA) &gt;
&lt;!ELEMENT response  (#PCDATA) &gt;



&lt;!ATTLIST post
         id           	CDATA   #REQUIRED
		 user			CDATA 	#REQUIRED
		 category		CDATA 	#REQUIRED
		 date			CDATA 	#REQUIRED&gt;
&lt;!ATTLIST response
         user			CDATA 	#REQUIRED
		 date			CDATA 	#REQUIRED&gt;
</pre>
<div class="solution">Barème<ol class="spip"><li> Utilisation de ELEMENT</li><li> Utilisation de ATTLIST</li><li> Utilisation de *</li><li> Utilisation de REQUIRED</li></ol></div>
</div> 
 
<div id="reponses18573">
 

<div class="forum-repondre">
	<b><a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#s10">Obtenir un formulaire de réponse à la question 1</a></b>
</div>
</div><br><span id="e18574"></span>


<h2 id="a2">2 Chargement du forum <small>(8&nbsp;point(s))</small></h2>
<p>A l’aide de la fonction <tt>lancer_phraseur</tt> étudiée ce semestre et donnée dans l’annexe <tt>functions.php</tt>, écrire les preneurs d’évènements (ouverture, fermeture, et texte) qui, à partir du fichier <tt>forum.xml</tt> construisent un tableau PHP <tt>$forum</tt>  de la forme suivante (un exemple complet est donné dans le fichier <tt>constantes.php</tt>)&nbsp;:</p>
<div class="spip_code"><code>array(<br>
 &nbsp;"id du post" =&gt; array(<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"category" =&gt; "Programmation ...",<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"subject" =&gt; "PHP",<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"user" &nbsp; &nbsp;=&gt; "md5",<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"text" &nbsp; &nbsp;=&gt; "Le texte principal du post",<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"date" &nbsp; &nbsp;=&gt; "20/12/2015"<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"responses" =&gt; array(<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;array("user"=&gt;"md5", "date"=&gt;"21/12/2015", &nbsp;"text"=&gt;"réponse"), ... ) &nbsp;) )</code></div>




<div class="solution" id="s2">
<div>Solution
      <a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4790&amp;cle=d2f561686607ab16f837f39c6e7fd31aee82203f&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fforum.sax.php" style="float:right" class="solution">Télécharger forum.sax.php</a></div>
<p><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">require_once(</span><span style="color: #DD0000">"constantes.php"</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;require_once(</span><span style="color: #DD0000">"functions.php"</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$texte&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$forum&nbsp;</span><span style="color: #007700">=&nbsp;array();
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$idpost</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$respDate</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">ouverture</span><span style="color: #007700">(</span><span style="color: #0000BB">$parser</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$name</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$attrs</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$forum</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$idpost</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$respDate</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">"post"</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$idpost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$attrs</span><span style="color: #007700">[</span><span style="color: #DD0000">"id"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$attrs</span><span style="color: #007700">[</span><span style="color: #DD0000">"user"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$category&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$attrs</span><span style="color: #007700">[</span><span style="color: #DD0000">"category"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$attrs</span><span style="color: #007700">[</span><span style="color: #DD0000">"date"</span><span style="color: #007700">];&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//initialisation&nbsp;de&nbsp;l'entrée&nbsp;correspondante&nbsp;au&nbsp;post&nbsp;courant
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$forum</span><span style="color: #007700">[</span><span style="color: #0000BB">$idpost</span><span style="color: #007700">]&nbsp;=&nbsp;array(
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"category"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$category</span><span style="color: #007700">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"user"&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"date"&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$date</span><span style="color: #007700">,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"responses"&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array());
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}elseif(</span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">"response"</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$attrs</span><span style="color: #007700">[</span><span style="color: #DD0000">"user"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$respDate&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$attrs</span><span style="color: #007700">[</span><span style="color: #DD0000">"date"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<br>&nbsp;&nbsp;&nbsp;&nbsp;}
<br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">fermeture</span><span style="color: #007700">(</span><span style="color: #0000BB">$parser</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$name</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$forum</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$idpost</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$texte</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$respDate</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">"subject"</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$forum</span><span style="color: #007700">[</span><span style="color: #0000BB">$idpost</span><span style="color: #007700">][</span><span style="color: #DD0000">"subject"</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$texte</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}elseif(</span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">"text"</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$forum</span><span style="color: #007700">[</span><span style="color: #0000BB">$idpost</span><span style="color: #007700">][</span><span style="color: #DD0000">"text"</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$texte</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}elseif(</span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">"response"</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$response&nbsp;</span><span style="color: #007700">=&nbsp;&nbsp;array(</span><span style="color: #DD0000">"user"</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"date"</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$respDate</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"text"</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$texte</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$forum</span><span style="color: #007700">[</span><span style="color: #0000BB">$idpost</span><span style="color: #007700">][</span><span style="color: #DD0000">"responses"</span><span style="color: #007700">][</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$forum</span><span style="color: #007700">[</span><span style="color: #0000BB">$idpost</span><span style="color: #007700">][</span><span style="color: #DD0000">"responses"</span><span style="color: #007700">])]&nbsp;=&nbsp;</span><span style="color: #0000BB">$response</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$texte&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;}
<br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">texte</span><span style="color: #007700">(</span><span style="color: #0000BB">$parser</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$texte</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$data&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">trim</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$texte&nbsp;&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #0000BB">$data</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;}
<br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//Test
<br>&nbsp;&nbsp;&nbsp;&nbsp;//lancer_phraseur(FORUM_FILE);
<br>&nbsp;&nbsp;&nbsp;&nbsp;//print_r($forum);
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></p>
<div class="solution">Barème<ol class="spip"><li> Inclusion de "functions.php"</li><li> Déclaration des variables globales</li><li> Détection de la balise ouvrante "post"</li><li> Récupération des attributs </li><li> Remplissage du tableau</li><li> Détection des balises fermantes nécessaires</li><li> Sauvegarde de réponse au bon endroit </li><li> Suppresion des espaces inutiles</li></ol></div>
</div> 
 
<div id="reponses18574">
 

<div class="forum-repondre">
	<b><a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#s20">Obtenir un formulaire de réponse à la question 2</a></b>
</div>
</div><br><span id="e18576"></span>


<h2 id="a3">3 Sauvegarder une réponse <small>(3&nbsp;point(s))</small></h2>
<p>Pour garder les informations du forum à jour, il faut insérer chaque nouveau message dans le tableau des messages précédents, et sauver ce tableau dans un fichier.  Écrire une fonction PHP <tt>inserer_reponse</tt> qui reçoit en arguments&nbsp;:</p>

<ul class="spip"><li> <tt>$forum</tt>, un tableau comme décrit ci-dessus</li><li> <tt>$file</tt>, un nom de fichier,</li><li> <tt>$id_post</tt>, un identifiant de message,</li><li> <tt>$from</tt>, un identifiant d’utilisateur,</li><li> <tt>$texte</tt>, une réponse au message <tt>id_post</tt>,</li><li> <tt>$date</tt> la date de cette réponse,</li></ul>
<p>et qui doit insérer la réponse au bon endroit dans le tableau $forum.
Cette fonction doit retourner True en cas de succès, False si une erreur se produit.</p>




<div class="solution" id="s3">
<div>Solution
      <a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4791&amp;cle=90f832714ffcedcc186077dd7ab4b4a4e19776a4&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Finserer_commentaire.php" style="float:right" class="solution">Télécharger inserer_commentaire.php</a></div>
<p><code><span style="color: #000000">
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0000BB">&lt;?php
<br></span><span style="color: #007700">require_once(</span><span style="color: #DD0000">"functions.php"</span><span style="color: #007700">);
<br>
<br>function&nbsp;</span><span style="color: #0000BB">inserer_reponse</span><span style="color: #007700">(</span><span style="color: #0000BB">$forum</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$file</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$id_post</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$from</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$texte</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$date</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;if(!isset(</span><span style="color: #0000BB">$forum</span><span style="color: #007700">[</span><span style="color: #0000BB">$id_post</span><span style="color: #007700">])){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;}else{
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$forum</span><span style="color: #007700">[</span><span style="color: #0000BB">$id_post</span><span style="color: #007700">][</span><span style="color: #DD0000">"responses"</span><span style="color: #007700">][</span><span style="color: #0000BB">count</span><span style="color: #007700">(</span><span style="color: #0000BB">$forum</span><span style="color: #007700">[</span><span style="color: #0000BB">$id_post</span><span style="color: #007700">][</span><span style="color: #DD0000">"responses"</span><span style="color: #007700">])]&nbsp;=&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;array(</span><span style="color: #DD0000">"user"</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$from</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"date"</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$date</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"text"</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$texte</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;}
<br>}
<br></span><span style="color: #0000BB">?&gt;
<br></span>
</span>
</code></p>
<div class="solution">Barème<ol class="spip"><li> Test d’existence du message</li><li> Création du tableau de la réponse</li><li> Insertion de la réponse au bon endroit</li></ol></div>
</div> 
 
<div id="reponses18576">
 

<div class="forum-repondre">
	<b><a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#s40">Obtenir un formulaire de réponse à la question 3</a></b>
</div>
</div><br><span id="e18577"></span>


<h2 id="a4">4 Script d’insertion d’une réponse <small>(8&nbsp;point(s))</small></h2>
<p>Maintenant que la fonction de sauvegarde est définie, il faut écrire un script recevant la demande d’ajout via la méthode GET. Ce script vérifiera que toutes les informations sont valides avant de sauvegarder.</p>

<p>Le script PHP reçoit trois paramètres GET&nbsp;:</p>

<ul class="spip"><li> <tt>id_post</tt>, qui correspond à un identifiant d’un message,</li><li> <tt>texte</tt>, qui correspond au contenu d’une réponse à un message dont l’identifiant est <tt>id_post</tt>,</li><li> <tt>date</tt>, qui correspond à la date de la génération de la réponse,</li></ul>
<p>et doit&nbsp;:</p>

<ul class="spip"><li> renvoyer le statut 400, bad request («&nbsp;mauvaise requête&nbsp;» en français)  s’il manque un argument dans la requête GET&nbsp;;</li><li> vérifier qu’il existe un cookie nommé <tt>code_auth</tt>, dont la valeur désigne un utilisateur dans le tableau <tt>$users</tt>&nbsp;;</li><li> si ce n’est pas le cas, renvoyer le status 401, «&nbsp;unauthorized&nbsp;» («&nbsp;non autorisé&nbsp;» en français)&nbsp;;</li><li> si c’est bien le cas&nbsp;:<ul class="spip"><li>  enregistrer la réponse à l’aide de la fonction <tt>inserer_reponse</tt>, et renvoyer encore le statut 400 si cette fonction renvoie False (échec de l’insertion),</li><li> si l’insertion se passe bien, renvoyer le statut 200 OK puis une réponse formée d’une  balise HTML <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/struct/global.html#edef-DIV" class="spip_glossaire" title="Voir la description de &#39;div&#39; dans la documentation de &#39;html&#39;" rel="external">div</a>  contenant 3 balises HTML <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/struct/global.html#edef-SPAN" class="spip_glossaire" title="Voir la description de &#39;span&#39; dans la documentation de &#39;html&#39;" rel="external">span</a> successives&nbsp;:<ul class="spip"><li> une contenant l’auteur de la réponse,</li><li> une  contenant le texte de la réponse,</li><li> une contenant la date de la réponse.</li></ul></li></ul></li></ul>




<div class="solution" id="s4">
<div>Solution
      <a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4789&amp;cle=14e2c4ab940bec6980d93a794c291572bced2296&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fforum.http.php" style="float:right" class="solution">Télécharger forum.http.php</a></div>
<p><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php
<br></span><span style="color: #007700">require_once(</span><span style="color: #DD0000">"constantes.php"</span><span style="color: #007700">);
<br>require_once(</span><span style="color: #DD0000">"inserer_commentaire.php"</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br>if((!isset(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"id_post"</span><span style="color: #007700">]))&nbsp;||&nbsp;(!isset(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"texte"</span><span style="color: #007700">]))&nbsp;||&nbsp;(!isset(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"date"</span><span style="color: #007700">]))){
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"HTTP/1.1&nbsp;400&nbsp;Bad&nbsp;Request"</span><span style="color: #007700">);
<br>}else{
<br>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!isset(</span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">[</span><span style="color: #DD0000">"code_auth"</span><span style="color: #007700">])&nbsp;||&nbsp;!isset(</span><span style="color: #0000BB">$users</span><span style="color: #007700">[</span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">[</span><span style="color: #DD0000">"code_auth"</span><span style="color: #007700">]])){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"HTTP/1.1&nbsp;401&nbsp;Unauthorized"</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$users</span><span style="color: #007700">[</span><span style="color: #0000BB">$_COOKIE</span><span style="color: #007700">[</span><span style="color: #DD0000">"code_auth"</span><span style="color: #007700">]];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$mainText&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"texte"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$date&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"date"</span><span style="color: #007700">];
<br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">inserer_reponse</span><span style="color: #007700">(</span><span style="color: #0000BB">$forum</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">FORUM_FILE</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">"id_post"</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$mainText</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$date</span><span style="color: #007700">))&nbsp;{
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"HTTP/1.1&nbsp;200&nbsp;OK"</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;div&gt;&lt;span&gt;"</span><span style="color: #007700">,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"&lt;/span&gt;&lt;span&gt;"</span><span style="color: #007700">,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$mainText</span><span style="color: #007700">,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"&lt;/span&gt;&lt;span&gt;"</span><span style="color: #007700">,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$date</span><span style="color: #007700">,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"&lt;/span&gt;&lt;/div&gt;"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"HTTP/1.1&nbsp;400&nbsp;Bad&nbsp;Request"</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<br>&nbsp;&nbsp;&nbsp;&nbsp;}
<br>}
<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></p>
<div class="solution">Barème<ol class="spip"><li> Test de réception des données GET</li><li> Envoi du status 400 bad request</li><li> Accès au cookie</li><li> Test sur le cookie et sur le tableau $user</li><li> Envoi du header 401</li><li> Appel à la fonction inserer_reponse</li><li> Envoi du header 200</li><li> Envoi de la réponse HTML</li></ol></div>
</div> 
 
<div id="reponses18577">
 

<div class="forum-repondre">
	<b><a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#s50">Obtenir un formulaire de réponse à la question 4</a></b>
</div>
</div><br><span id="e18578"></span>


<h2 id="a5">5 Présentation des messages <small>(8&nbsp;point(s))</small></h2>
<p>Ecrire une fonction PHP <tt>array_to_html</tt> qui reçoit en arguments&nbsp;:</p>

<ol class="spip"><li> le tableau contenant l’ensemble des messages et les réponses associées (<tt>$forum</tt> fourni en annexe) </li><li> le tableau des noms d’utilisateur indexé par le code correspondant (<tt>$users</tt>).</li></ol>
<p>Cette fonction retourne en résultat une suite de balises HTML <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/struct/global.html#edef-DIV" class="spip_glossaire" title="Voir la description de &#39;div&#39; dans la documentation de &#39;html&#39;" rel="external">div</a>, chacune correspondant à un message principal dans le tableau PHP <tt>$forum</tt>, et contenant&nbsp;:</p>

<ul class="spip"><li> un attribut HTML <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/struct/global.html#adef-class" class="spip_glossaire" title="Voir la description de &#39;class&#39; dans la documentation de &#39;html&#39; section 1" rel="external">class</a> de valeur «&nbsp;billet&nbsp;»&nbsp;;</li><li> un attribut HTML <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/interact/scripts.html#adef-onclick" class="spip_glossaire" title="Voir la description de &#39;onclick&#39; dans la documentation de &#39;html&#39; section 1" rel="external">onclick</a> ayant comme  valeur l’application de la fonction <tt>voir_message</tt> à l’élément cliqué (cette fonction fera objet d’une question ultérieure)&nbsp;;</li><li> trois balises HTML <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/struct/global.html#edef-SPAN" class="spip_glossaire" title="Voir la description de &#39;span&#39; dans la documentation de &#39;html&#39;" rel="external">span</a> contenant respectivement le nom et le prénom de l’utilisateur ayant édité le message principal, le sujet, et la date de l’édition du message principal&nbsp;;</li><li> une balise HTML <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/struct/global.html#edef-DIV" class="spip_glossaire" title="Voir la description de &#39;div&#39; dans la documentation de &#39;html&#39;" rel="external">div</a> de <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/struct/global.html#adef-class" class="spip_glossaire" title="Voir la description de &#39;class&#39; dans la documentation de &#39;html&#39; section 1" rel="external">class</a> "comments", contenant autant de balises HTML <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/struct/global.html#edef-DIV" class="spip_glossaire" title="Voir la description de &#39;div&#39; dans la documentation de &#39;html&#39;" rel="external">div</a> que de réponses à ce message, chacune de ces balises contenant trois balises HTML <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/struct/global.html#edef-SPAN" class="spip_glossaire" title="Voir la description de &#39;span&#39; dans la documentation de &#39;html&#39;" rel="external">span</a> correspondant respectivement au nom et prénom de l’éditeur de la réponse, son texte et sa date,</li><li> un formulaire permettant de répondre au message principal, ainsi formé&nbsp;:<ul class="spip"><li> une saisie cachée contenant l’identifiant du message principal auquel on répond, avec l’attribut HTML <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/types.html#type-name" class="spip_glossaire" title="Voir la description de &#39;name&#39; dans la documentation de &#39;html&#39; section 1" rel="external">name</a> égal à «&nbsp;id_post&nbsp;»,</li><li> un champ de saisie de texte libre, avec l’attribut HTML <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/types.html#type-name" class="spip_glossaire" title="Voir la description de &#39;name&#39; dans la documentation de &#39;html&#39; section 1" rel="external">name</a> égal à «&nbsp;texte&nbsp;» et un attribut HTML <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/html4/struct/global.html#adef-id" class="spip_glossaire" title="Voir la description de &#39;id&#39; dans la documentation de &#39;html&#39; section 1" rel="external">id</a> égal à l’identifiant du message principal&nbsp;; cela permettra d’associer également un label à ce champ de saisi pour respecter les règles d’accessibilité,</li><li> un bouton de soumission du formulaire.</li></ul></li></ul>
<p>La soumission doit être conditionnée à une fonction JavaScript booléenne <tt>soumettre_reponse</tt> permettant de l’empêcher au besoin. Cette fonction fait l’objet d’une question ultérieure.</p>

<p>En résumé la fonction PHP demandée doit présenter les messages et leurs réponses suivies d’un formulaire. Leur présentation  sera gérée dans la prochaine question par une feuille de styles.</p>




<div class="solution" id="s5">
<div>Solution
      <a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4777&amp;cle=41986ee22428a96123a61a429f1ea0f08f387828&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fgenerer_html.php" style="float:right" class="solution">Télécharger generer_html.php</a></div>
<p><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php
<br></span><span style="color: #007700">require_once(</span><span style="color: #DD0000">"constantes.php"</span><span style="color: #007700">);
<br>require_once(</span><span style="color: #DD0000">"forum.sax.php"</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br>function&nbsp;</span><span style="color: #0000BB">array_to_html</span><span style="color: #007700">(</span><span style="color: #0000BB">$forum</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$users</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$html&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">$forum&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$id_post&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$post</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$userId&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$post</span><span style="color: #007700">[</span><span style="color: #DD0000">"user"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$userName&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$users</span><span style="color: #007700">[</span><span style="color: #0000BB">$userId</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$postDate&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$post</span><span style="color: #007700">[</span><span style="color: #DD0000">"date"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$mainText&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$post</span><span style="color: #007700">[</span><span style="color: #DD0000">"text"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"&lt;div&nbsp;class='billet'&nbsp;onclick='voir_message(this)'&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;span&nbsp;class='user_name'&gt;$userName&lt;/span&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;span&nbsp;class='main_text'&gt;$mainText&lt;/span&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;span&nbsp;class='date'&gt;$postDate&lt;/span&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//récupération&nbsp;des&nbsp;réponses&nbsp;à&nbsp;un&nbsp;billet
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$responses&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$post</span><span style="color: #007700">[</span><span style="color: #DD0000">"responses"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;div&nbsp;class='comments'&gt;\n"</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">$responses&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$response</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$commentUserName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$users</span><span style="color: #007700">[</span><span style="color: #0000BB">$response</span><span style="color: #007700">[</span><span style="color: #DD0000">"user"</span><span style="color: #007700">]];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$commentDate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$response</span><span style="color: #007700">[</span><span style="color: #DD0000">"date"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$commentText&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$response</span><span style="color: #007700">[</span><span style="color: #DD0000">"text"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;div&nbsp;class='comment'&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;span&nbsp;class='user_name'&gt;$commentUserName&lt;/span&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;span&nbsp;class='main_text'&gt;$commentText&lt;/span&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;span&nbsp;class='date'&gt;$commentDate&lt;/span&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;/div&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//Construction&nbsp;du&nbsp;formulaire
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;form&nbsp;method='POST'&nbsp;action=''&nbsp;onsubmit='return&nbsp;soumettre_reponse(this)'&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;fieldset&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;input&nbsp;type='hidden'&nbsp;name='id_post'&nbsp;value='$id_post'&nbsp;/&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;label&nbsp;for='$id_post'&gt;R&amp;eacute;ponse&nbsp;:&nbsp;&lt;/label&gt;&lt;input&nbsp;id='$id_post'&nbsp;type='text'&nbsp;name='texte'&nbsp;value=''&nbsp;/&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;input&nbsp;type='submit'&nbsp;value='Envoyer'&nbsp;/&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;/fieldset&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;/form&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;/div&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$div&nbsp;&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;/div&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$html&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$html</span><span style="color: #007700">.</span><span style="color: #0000BB">$div</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$html</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;}
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></p>
<div class="solution">Barème<ol class="spip"><li> Récupération du userName</li><li> Attribut onclick </li><li> Balises span </li><li> Construction du formulaire</li><li> Attribut onsubmit</li><li> Champ hidden</li><li> Balise input</li><li> Balise label avec attribut for correct</li></ol></div>
</div> 
 
<div id="reponses18578">
 

<div class="forum-repondre">
	<b><a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#s60">Obtenir un formulaire de réponse à la question 5</a></b>
</div>
</div><br><span id="e18579"></span>


<h2 id="a6">6 Ajouter du style <small>(7&nbsp;point(s))</small></h2>
<p>Proposez une feuille de styles réalisant les spécifications suivantes sur la structure HTML ci-dessus&nbsp;:</p>

<ul class="spip"><li> chaque message principal (classe billet) doit être entouré d’une bordure en couleur bleu, de largeur de 2 pixels, et son contenu doit être en gras (propriété CSS <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/css2/fonts.html#propdef-font-weight" class="spip_glossaire" title="Voir la description de &#39;font-weight&#39; dans la documentation de &#39;css&#39; section 3" rel="external">font-weight</a>)&nbsp;;</li><li> le nom de l’auteur du message principal doit apparaître  en italique (propriété CSS <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/css2/fonts.html#propdef-font-style" class="spip_glossaire" title="Voir la description de &#39;font-style&#39; dans la documentation de &#39;css&#39; section 3" rel="external">font-style</a>), en plus d’être en gras&nbsp;;</li><li> le texte de ce message, qui le suit sur la même ligne, doit être à 2 cadratins du nom&nbsp;;</li><li> la date du message principal doit être collée à droite de l’écran (propriété CSS <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/css2/visuren.html#propdef-float" class="spip_glossaire" title="Voir la description de &#39;float&#39; dans la documentation de &#39;css&#39;" rel="external">float</a>)&nbsp;;</li><li> chaque réponse au message principal doit avoir une couleur d’arrière-plan gris (code couleur <tt>#CCCCC</tt>) et ne plus être en gras&nbsp;;</li><li> le nom de l’auteur de la réponse doit toujours être en italique&nbsp;;</li><li> le survol du texte du message principal par la souris doit indiquer à l’utilisateur qu’on peut cliquer sur ce message en donnant à la propriété CSS <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/css2/ui.html#propdef-cursor" class="spip_glossaire" title="Voir la description de &#39;cursor&#39; dans la documentation de &#39;css&#39; section 9" rel="external">cursor</a> la valeur <tt>pointer</tt>, mais elle doit repasser  à <tt> normal</tt> partout ailleurs (notamment le texte d’une réponse)&nbsp;;</li><li> les réponses aux messages principaux ainsi que le formulaire permettant de saisir une réponse ne doivent pas être visibles au chargement de la page.</li></ul>




<div class="solution" id="s6">
<div>Solution
      <a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4793&amp;cle=ed4a5e8870e88287a11790a7dde6e9a8f727d05a&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fstyle.css" style="float:right" class="solution">Télécharger style.css</a></div>
<pre>.billet {
	border: 2px solid blue;
	font-weight:bold;
}

.billet&gt;span{
	font-style:italic;
}

.billet&gt;span+span{
	padding-left:2em;
	font-style:normal;
	cursor:pointer;
}

.billet span+span+span {
	float:right;
}

.billet&gt;div&gt;div{
	background-color:#CCCCCC;
	font-weight:normal;
}

.billet&gt;div&gt;div&gt;span {
	cursor:normal;
}

.billet&gt;div&gt;div&gt;span {
	cursor:normal;
}

.billet&gt;div&gt;div&gt;span:first-child {
	font-style:italic;
}

.billet&gt;div {
	display:none;
}
</pre>
<div class="solution">Barème<ol class="spip"><li> Sélecteur point</li><li> Sélecteur .billet&gt;span</li><li> Sélecteur +</li><li> Propriété float</li><li> Utiliation de first-child</li><li> Propriété display</li><li> Propriété sur les textes</li></ol></div>
</div> 
 
<div id="reponses18579">
 

<div class="forum-repondre">
	<b><a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#s70">Obtenir un formulaire de réponse à la question 6</a></b>
</div>
</div><br><span id="e18580"></span>


<h2 id="a7">7 Voir les réponses à un message <small>(4&nbsp;point(s))</small></h2>
<p>Ecrire la fonction <tt>voir_message</tt> qui reçoit en argument un élément correspondant à un message principal. Elle doit rendre invisibles toutes les réponses aux messages principaux, sauf celles répondant à l’élément donné en argument.</p>




<div class="solution" id="s7">
<div>Solution
      <a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4797&amp;cle=0e9b739137559957169d2bc1d1772d530eac9b59&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fvoir_message.js" style="float:right" class="solution">Télécharger voir_message.js</a></div>
<pre>function voir_message(billetElement){
	var elementToHide = document.getElementsByClassName("comments");
	for(var i = 0; i &lt; elementToHide.length; i++){
		elementToHide[i].style.display = "none";
	}
	
	billetElement.getElementsByClassName("comments")[0].style.display="block";
}</pre>
<div class="solution">Barème<ol class="spip"><li> Récupération des éléments relatifs aux messages</li><li> Invisibilité des messages</li><li> Sélection des messages de l’élément courant</li><li> Visibilité de ces messages</li></ol></div>
</div> 
 
<div id="reponses18580">
 

<div class="forum-repondre">
	<b><a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#s80">Obtenir un formulaire de réponse à la question 7</a></b>
</div>
</div><br><span id="e18581"></span>


<h2 id="a8">8 Envoi d’une réponse <small>(4&nbsp;point(s))</small></h2>
<p>Le script <i>forum.http.php</i> permet d’insérer une réponse à un message principal. Cette réponse est reçue sous forme de trois paramètres GET&nbsp;:</p>

<ul class="spip"><li> <tt>id_post</tt>, qui correspond à l’identifiant du message principal,</li><li> <tt>texte</tt>, qui correspond au contenu de la réponse,</li><li> <tt>date</tt>, qui correspond à la date de la génération de la réponse au format dd/mm/yyyy (e.g. 21/12/2015),</li></ul>
<p>Ecrire la fonction JavaScript <tt>soumettre_reponse</tt> qui reçoit en argument un nœud de formulaire (celui permettant à l’utilisateur de saisir une réponse à un message principal). Elle génère la date courante, et envoie en AJAX et en méthode GET l’ensemble de ces données au script <i>forum.http.php</i>. 
La réponse à cette requête AJAX devra être traitée par la fonction JavaScript <tt>resultat_insertion</tt> qui fait l’objet de la question suivante.
La fonction <tt>ajax</tt> utilisée cette année est donnée en annexe.</p>




<div class="solution" id="s8">
<div>Solution
      <a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4781&amp;cle=40fd87316fd1778e1087ae001ddffe5fed786800&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fsoumettre_reponse.js" style="float:right" class="solution">Télécharger soumettre_reponse.js</a></div>
<pre>function soumettre_reponse(form){
	//récupération des valeur du formulaire
	var post_id = form.elements["id_post"].value;
	var texte	= form.elements["texte"].value;
	
	//Génération de la date
	var d		= new Date();	
	var dString = d.getDate() + "/" + d.getMonth() + "/" + d.getFullYear();
	
	//construction de l'url
	var url = "forum.http.php?id_post="+post_id+"&amp;texte="+texte+"&amp;date="+dString;
	
	ajax(url, "", resultat_insertion, "GET");
	
	return false;
}
</pre>
<div class="solution">Barème<ol class="spip"><li> Récupération des valeur de id_post et texte</li><li> Génération de la date </li><li> Création de l’URL</li><li> Utilisation d’AJAX</li></ol></div>
</div> 
 
<div id="reponses18581">
 

<div class="forum-repondre">
	<b><a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#s85">Obtenir un formulaire de réponse à la question 8</a></b>
</div>
</div><br><span id="e18582"></span>


<h2 id="a9">9 Signalement de l’insertion <small>(4&nbsp;point(s))</small></h2>
<p>Ecrire la fonction JavaScript <tt>resultat_insertion</tt> qui lit le code de retour  de la requête HTTP et ouvre une fenêtre l’explicitant ainsi&nbsp;:</p>

<ul class="spip"><li> si le code indique un succès, la fenêtre affiche que le message est inséré&nbsp;;</li><li> si le code indique une erreur, la fenêtre  affiche sa valeur et un texte explicatif pour les deux cas 400 et 401 produits par le code PHP écrit précédemment.</li></ul>




<div class="solution" id="s9">
<div>Solution
      <a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4780&amp;cle=b7471bc745c1b7a1d778de0bbb9d8b4ce8b07cee&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fresultat_insertion.js" style="float:right" class="solution">Télécharger resultat_insertion.js</a></div>
<pre>function resultat_insertion(xhr){
	if ( xhr.readyState == 4 ) {
	  if (xhr.status == 401) {
		  alert("Erreur 401: Non authorisé");
	  }else if(xhr.status == 400){
		  alert("Erreur 400: Mauvaise requête");
	  }else if(xhr.status == 200){
		  alert("Code 200: Commentaire inséré");
	  }
	}	  
}</pre>
<div class="solution">Barème<ol class="spip"><li> Test sur ready_state</li><li> Cas des status 400 et 401,</li><li> Cas du status 200, </li><li> Texte explicatif</li></ol></div>
</div> 
 
<div id="reponses18582">
 

<div class="forum-repondre">
	<b><a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#s90">Obtenir un formulaire de réponse à la question 9</a></b>
</div>
</div><br><span id="e18585"></span>


<h2 id="a10">10 Application complète <small>(4&nbsp;point(s))</small></h2>
<p>A l’aide des fichiers PHP déjà écrits, construire un script PHP, qui charge le forum et affiche le contenu sous forme d’une page HTML valide. Cette page doit référencer  les fichiers CSS et JavaScript écrits précédemment. Elle doit également permettre d’afficher les réponses à un message principal lorsque l’utilisateur clique sur ce dernier. A cette même occasion, elle doit également afficher le formulaire permettant à l’utilisateur de répondre au message principal cliqué.</p>




<div class="solution" id="s10">
<div>Solution
      <a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4794&amp;cle=c46aeb0885d1c14815e0fb6e101a8be9b3acce59&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fforum.html.php" style="float:right" class="solution">Télécharger forum.html.php</a></div>
<p><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">require_once(</span><span style="color: #DD0000">"entete.php"</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;require_once(</span><span style="color: #DD0000">"generer_html.php"</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$links&nbsp;</span><span style="color: #007700">=&nbsp;array(array(</span><span style="color: #DD0000">"rel"</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"stylesheet"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"type"</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"text/css"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"href"</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"style.css"</span><span style="color: #007700">));
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">entete</span><span style="color: #007700">(</span><span style="color: #DD0000">"forum"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$links</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;body&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">lancer_phraseur</span><span style="color: #007700">(</span><span style="color: #0000BB">FORUM_FILE</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">array_to_html</span><span style="color: #007700">(</span><span style="color: #0000BB">$forum</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$users</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;script&nbsp;type='text/javascript'&nbsp;src='voir_message.js'&gt;&lt;/script&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;script&nbsp;type='text/javascript'&nbsp;src='ajax.js'&gt;&lt;/script&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;script&nbsp;type='text/javascript'&nbsp;src='resultat_insertion.js'&gt;&lt;/script&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;script&nbsp;type='text/javascript'&nbsp;src='soumettre_reponse.js'&gt;&lt;/script&gt;\n"</span><span style="color: #007700">;
<br>
<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;/body&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&lt;/html&gt;\n"</span><span style="color: #007700">;
<br></span><span style="color: #0000BB">?&gt;
<br></span>
</span>
</code></p>
<div class="solution">Barème<ol class="spip"><li> référencement CSS</li><li> référencement javascript</li><li> XHTML valide</li><li> lancer_phraseur et array_to_html</li></ol></div>
</div> 
 
<div id="reponses18585">
 

<div class="forum-repondre">
	<b><a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#s93">Obtenir un formulaire de réponse à la question 10</a></b>
</div>
</div><br><span id="e18583"></span>


<h2 id="a11">11 Statistiques en SVG <small>(6&nbsp;point(s))</small></h2>
<p>On souhaite présenter des statistiques d’utilisation du forum sous forme d’un histogramme où la hauteur d’un rectangle représente le nombre total de messages d’un utilisateur (cf visualisation.pdf). Cet histogramme sera formé d’autant de balises SVG <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/SVG11/shapes.html#RectElement" class="spip_glossaire" title="Voir la description de &#39;rect&#39; dans la documentation de &#39;svg&#39; section 9" rel="external">rect</a> qu’il y a d’utilisateurs, avec&nbsp;:</p>

<ul class="spip"><li> une largeur fixe égale à 30, </li><li> une hauteur égale au nombre de participations de l’utilisateur au forum, multiplié par 10,</li><li> la position en X sera décalée de 100 pour chaque nouveau rectangle,</li><li> et la position en Y sera égale à la longueur maximum trouvée moins la longueur du rectangle en cours (cela permettra d’aligner les rectangle par le bas),</li><li> chaque rectangle devra être légendé par le nom et prénom de l’utilisateur correspondant, à l’aide d’une balise SVG <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/SVG11/text.html#TextElement" class="spip_glossaire" title="Voir la description de &#39;text&#39; dans la documentation de &#39;svg&#39; section 10" rel="external">text</a> positionnée juste au dessous du rectangle correspondant, avec une taille du texte correspondant à 60% (propriété CSS <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/css2/fonts.html#propdef-font-size" class="spip_glossaire" title="Voir la description de &#39;font-size&#39; dans la documentation de &#39;css&#39; section 3" rel="external">font-size</a>).</li></ul>
<p>Écrire une fonction PHP  <tt>get_histogram</tt> qui prend en argument le tableau <tt>$forum</tt> et le tableau <tt>$users</tt> et retourne en résultat cette suite de balises entourée de la balise racine <a href="http://www-ari.ufr-info-p6.jussieu.fr/OUTILS/documentation/doc/SVG11/struct.html#SvgElement" class="spip_glossaire" title="Voir la description de &#39;svg&#39; dans la documentation de &#39;svg&#39; section 5" rel="external">svg</a> spécifiant une dimension totale de 500x500.</p>




<div class="solution" id="s11">
<div>Solution
      <a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4792&amp;cle=fc3bcc8c142663886fedba09a07907bf8ad2c403&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fstats.svg.php" style="float:right" class="solution">Télécharger stats.svg.php</a></div>
<p><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php
<br></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">get_histogram</span><span style="color: #007700">(</span><span style="color: #0000BB">$forum</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$users</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$svg&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"&lt;svg&nbsp;width='500'&nbsp;height='500'&gt;\n&lt;g&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$max&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$nbContrib&nbsp;</span><span style="color: #007700">=&nbsp;array();
<br>&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">$forum&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$post</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$responses&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$post</span><span style="color: #007700">[</span><span style="color: #DD0000">"responses"</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">$responses&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$response</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$userId&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$response</span><span style="color: #007700">[</span><span style="color: #DD0000">"user"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$userName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$users</span><span style="color: #007700">[</span><span style="color: #0000BB">$userId</span><span style="color: #007700">];
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!isset(</span><span style="color: #0000BB">$nbContrib</span><span style="color: #007700">[</span><span style="color: #0000BB">$userName</span><span style="color: #007700">]))
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$nbContrib</span><span style="color: #007700">[</span><span style="color: #0000BB">$userName</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$nbContrib</span><span style="color: #007700">[</span><span style="color: #0000BB">$userName</span><span style="color: #007700">]++;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<br>&nbsp;&nbsp;&nbsp;&nbsp;}
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$posX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$maxHeight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">max</span><span style="color: #007700">(</span><span style="color: #0000BB">$nbContrib</span><span style="color: #007700">)*</span><span style="color: #0000BB">10</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;foreach(</span><span style="color: #0000BB">$nbContrib&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$userName&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$nb</span><span style="color: #007700">){
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$height&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$nb&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$posY&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$maxHeight&nbsp;</span><span style="color: #007700">-&nbsp;</span><span style="color: #0000BB">$height</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$posYText&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$maxHeight&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$svg&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"\t&lt;rect&nbsp;width='30'&nbsp;height='$height'&nbsp;x='$posX'&nbsp;y='$posY'&nbsp;/&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$svg&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"\t&lt;text&nbsp;x='$posX'&nbsp;y='$posYText'&nbsp;font-size='60%'&gt;$userName&lt;/text&gt;\n\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$posX&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$posX&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">100</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;}
<br>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$svg&nbsp;</span><span style="color: #007700">.=&nbsp;</span><span style="color: #DD0000">"&lt;/g&gt;\n&lt;/svg&gt;\n"</span><span style="color: #007700">;
<br>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$svg</span><span style="color: #007700">;
<br>}
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br></span><span style="color: #FF8000">//Test
<br></span><span style="color: #007700">require_once(</span><span style="color: #DD0000">"constantes.php"</span><span style="color: #007700">);
<br>require_once(</span><span style="color: #DD0000">"functions.php"</span><span style="color: #007700">);
<br>require_once(</span><span style="color: #DD0000">"forum.sax.php"</span><span style="color: #007700">);
<br></span><span style="color: #0000BB">lancer_phraseur</span><span style="color: #007700">(</span><span style="color: #0000BB">FORUM_FILE</span><span style="color: #007700">);
<br>&nbsp;&nbsp;&nbsp;&nbsp;
<br>echo&nbsp;</span><span style="color: #0000BB">get_histogram</span><span style="color: #007700">(</span><span style="color: #0000BB">$forum</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$users</span><span style="color: #007700">);
<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></p>
<div class="solution">Barème<ol class="spip"><li> Récupération du nombre de contributions des utilisateurs </li><li> Récupération du max</li><li> Calcul posY, position du rectangle</li><li> Calcul posYText, position de la légende</li><li> Génération de la balise rect</li><li> Génération de la balise text avec le font-size</li></ol></div>
</div> 
 
<div id="reponses18583">
 

<div class="forum-repondre">
	<b><a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/Forum#s95">Obtenir un formulaire de réponse à la question 11</a></b>
</div>
</div><br><span id="e18584"></span>

<h2 id="a12">12 Annexes <small>(-14&nbsp;point(s))</small></h2>

<div class="documents-joints">

<a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4785&amp;cle=2cb93976b1ce535e9adee750c3afe33400e2f656&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fajax.js" type="text/plain" title="texte - - ajax.js"><img src="./index_files/txt-56069-52702.png" width="52" height="52" style="height:52px;width:52px;" alt="" class="spip_logos"></a><br>ajax.js
<br>
<a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4786&amp;cle=cf7d61876037f7e86977df7fc92c2a250d865689&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fconstantes.php" type="text/plain" title="texte - - constantes.php"><img src="./index_files/txt-56069-52702.png" width="52" height="52" style="height:52px;width:52px;" alt="" class="spip_logos"></a><br>constantes.php
<br>
<a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4787&amp;cle=1f59af24902e5ca0921573b75fe36942f81a3a81&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fforum.xml" type="application/xml" title="XML - - forum.xml"><img src="./index_files/xml-50a01-8ab84.png" width="52" height="52" style="height:52px;width:52px;" alt="" class="spip_logos"></a><br>forum.xml
<br>
<a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4788&amp;cle=337fc87a40383c177f54ede820c8949210005e1c&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Ffunctions.php" type="text/plain" title="texte - - functions.php"><img src="./index_files/txt-56069-52702.png" width="52" height="52" style="height:52px;width:52px;" alt="" class="spip_logos"></a><br>functions.php
<br>
<a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4795&amp;cle=25942d53f82bd1ad6631f32802fef027b5140b3f&amp;file=distant%2FVCS%2F3I016%2FCC%2F2015-2016%2F2%2Fentete.php" type="text/plain" title="texte - - entete.php"><img src="./index_files/txt-56069-52702.png" width="52" height="52" style="height:52px;width:52px;" alt="" class="spip_logos"></a><br>entete.php
<br>
<a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?action=acceder_document&amp;arg=4798&amp;cle=4aca8ddfbd41d92071fe1e730475a4fcf2444d80&amp;file=pdf%2Fvisualisation.pdf" type="application/pdf" title="PDF - 16.3 ko - visualisation.pdf"><img src="./index_files/pdf-eb697-ec6f3.png" width="52" height="52" style="height:52px;width:52px;" alt="" class="spip_logos"></a><br>visualisation.pdf

</div>



<div style="text-align:right" id="s3301">
Fichier à créer&nbsp;: <tt>forum.dtd forum.sax.php inserer_commentaire.php forum.http.php generer_html.php style.css voir_message.js soumettre_reponse.js resultat_insertion.js forum.html.php stats.svg.php</tt><br>
</div>
 
 

</div><div id="pied" class="pied_page"><ul>
<li><a href="http://jigsaw.w3.org/css-validator/validator?uri=http%3A%2F%2Fwww-licence.ufr-info-p6.jussieu.fr%2Flmd%2Flicence%2F2015%2Fue%2F3I016-2015oct%2FForum" rel="noindex nofollow" class="validation-css" title="vérifier la validité CSS 2.1">Valid CSS 2.1</a></li>
<li><a href="http://validator.w3.org/check?uri=http%3A%2F%2Fwww-licence.ufr-info-p6.jussieu.fr%2Flmd%2Flicence%2F2015%2Fue%2F3I016-2015oct%2FForum" class="validation-xml" rel="noindex nofollow" title="vérifier la validité XHTML Baisc 1.1">Valid XHTML Basic 1.1</a></li>
<li><a href="http://www.contentquality.com/?url=http%3A%2F%2Fwww-licence.ufr-info-p6.jussieu.fr%2Flmd%2Flicence%2F2015%2Fue%2F3I016-2015oct%2FForum&amp;rptmode=2" class="validation-wcag" title="vérifier la validité WCAG 2.0 AAA">Triple-A conformance Web Content Accessibility Guidelines 2.0</a></li>
<li class="date-publi">
Calculé le 8 mars 2016 à 11h03min<br>
par 
<a href="https://www-licence.ufr-info-p6.jussieu.fr/lmd/licence/2015/ue/3I016-2015oct/spip.php?page=auteur&amp;id_auteur=1&amp;sujet=Signaler%20un%20souci%20technique%20avec%20le%20site%20SACS%202015%202016" rel="noindex nofollow" title="Signaler un souci technique avec le site">DidacSPIP</a><br>
Université Pierre et Marie Curie
</li>
<li><a href="http://validator.w3.org/mobile/check?docAddr=http%3A%2F%2Fwww-licence.ufr-info-p6.jussieu.fr%2Flmd%2Flicence%2F2015%2Fue%2F3I016-2015oct%2FForum" class="mobile-ok" rel="noindex nofollow" title="vérifier la validité Mobile OK">Mobile OK</a></li>
<li><a href="http://www.spip.net/" class="reference-spip" title="Visiter SPIP">SPIP</a></li>
</ul>
<script type="text/javascript" src="./index_files/admin_check.js"></script>
</div></div>

</body></html>